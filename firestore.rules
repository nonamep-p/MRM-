/**
 * @fileoverview Firestore Security Rules for VoyageVista Travel Agency.
 *
 * Core Philosophy:
 * This ruleset provides role-based and public data access, ensuring data integrity.
 * Public collections (travelPackages, packageAvailability, heroSlides, siteSettings) are readable by anyone,
 * while sensitive collections (contactFormSubmissions) are restricted to authenticated administrators.
 *
 * Data Structure:
 * - /travelPackages/{travelPackageId}: Publicly accessible travel package information.
 * - /packageAvailability/{availabilityId}: Publicly accessible package availability data.
 * - /contactFormSubmissions/{contactFormSubmissionId}: Contact form submissions, restricted to authenticated administrators.
 * - /siteSettings/main: Global site settings, publicly readable.
 * - /heroSlides/{heroSlideId}: Publicly accessible hero slide data for the homepage.
 *
 * Key Security Decisions:
 * - Read-only collections (travelPackages, packageAvailability, heroSlides, siteSettings) are readable by all users, including unauthenticated ones.
 * - Listing of contactFormSubmissions is only allowed for authenticated users, not for public access.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows read access to travel packages for all users and restricts write access.
     * @path /travelPackages/{travelPackageId}
     * @allow (get, list): Any user can read travel package information.
     * @deny (create, update, delete): No user can create, update, or delete travel packages.
     * @principle Allows public read access while restricting write access.
     */
    match /travelPackages/{travelPackageId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows read access to package availability for all users and restricts write access.
     * @path /packageAvailability/{availabilityId}
     * @allow (get, list): Any user can read package availability information.
     * @deny (create, update, delete): No user can create, update, or delete package availability records.
     * @principle Allows public read access while restricting write access.
     */
    match /packageAvailability/{availabilityId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Restricts access to contact form submissions to authenticated users.
     * @path /contactFormSubmissions/{contactFormSubmissionId}
     * @allow (get, list): Only authenticated users can read contact form submissions.
     * @deny (create, update, delete): No user can create, update, or delete contact form submissions through the client.
     * @principle Restricts access to sensitive data, requiring authentication.
     */
    match /contactFormSubmissions/{contactFormSubmissionId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if false;
    }

    /**
     * @description Allows read access to site settings for all users and restricts write access to authenticated users.
     * @path /siteSettings/main
     * @allow (get): Any user can read site settings.
     * @deny (create, update, delete): No user can create, update, or delete site settings through the client.
     * @principle Allows public read access while restricting write access.
     */
    match /siteSettings/main {
      allow get: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows read access to hero slides for all users and restricts write access.
     * @path /heroSlides/{heroSlideId}
     * @allow (get, list): Any user can read hero slide information.
     * @deny (create, update, delete): No user can create, update, or delete hero slides through the client.
     * @principle Allows public read access while restricting write access.
     */
    match /heroSlides/{heroSlideId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    function isSignedIn() {
      return request.auth != null;
    }
  }
}